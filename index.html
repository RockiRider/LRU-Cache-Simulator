<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />

  <title>Cache Simulation LRU</title>
  <meta name="description" content="Cache Simulation LRU" />
  <meta name="Tsotne Gvadzabia" />
</head>

<body>
  <h1>Title</h1>
  <section class="example"></section>
  <section class="inputer">
    <label for="define">Definition:</label>
    <input type="text" id="define" name="define" placeholder="8 4 2 2" required /><br /><br />
    <textarea id="input" rows="4" cols="50"></textarea>
    <br />
    <button id="startSim">Simulate</button>
  </section>

  <section class="asw">
    <h4 id="display">Answer Here</h4>
  </section>

  <script>

    getDef = () =>{
      return  document.getElementById("define").value
    }
    getInput = () =>{
      return document.getElementById("input").value
    }

    startSimulation = () => {
      
      var defined = getDef();
      var question = getInput();
      
      // ToDo defined in correct format with spaces

      var arrDefinition = defined.split(" ");
      var arrQuestions = question.match(/[^\r\n]+/g);
      
      // To Do check if array is correct length of 4.


      // Declerations Below
      const w = arrDefinition[0];
      const c = arrDefinition[1];
      const b = arrDefinition[2];
      const k = arrDefinition[3];


      let indexSizeCalc = c/b;
      let offsetSizeCalc = b/k;


      const indexSize = Math.log2(c/b/Math.log2(2));  // Maybe take away this log first
      const offsetSize = Math.log2(b/k)/Math.log2(2); // Take away this log last
      const tagSize = w - indexSize - offsetSize; //Might need a + instead of a -




      //Console Logs Below
      console.log(indexSize + " index");
      console.log(offsetSize + " off");
      console.log(tagSize + " tag");
      console.log(arrQuestions)


      var qLength = arrQuestions.length;

      var arrAddress = [];

      for(var i = 0; i<qLength;i++){
        let toNum = parseInt(arrQuestions[i]);
        let binaryVal = toNum.toString(2);

        //Ensure same number of binary bits
        if(binaryVal.length < w){
            let difference = w - binaryVal.length;
            for(var z = 0; z<difference;z++){
              binaryVal = '0'+binaryVal;
            }
        }
        arrAddress.push(binaryVal);
      }
      console.log(arrAddress);

      var arrOnlyTags = [];
      var addressLength = arrAddress.length;
      var removeChar = parseInt(indexSize + offsetSize);

      for(var y = 0; y < addressLength;y++){

        var temp = arrAddress[y].slice(0, -removeChar);
        arrOnlyTags.push(temp);

      }
      console.log(arrOnlyTags);

    };
    
    document.getElementById("startSim").addEventListener("click", startSimulation);
  </script>
</body>

</html>